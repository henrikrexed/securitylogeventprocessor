{"config":{"lang":["en"],"separator":"[\\s\\-]+","pipeline":["stopWordFilter"]},"docs":[{"location":"","title":"Security Log Event Processor","text":"<p>Welcome to the Security Log Event Processor documentation!</p> <p>The Security Log Event Processor is a custom OpenTelemetry Collector processor that transforms security-related logs into standardized security event logs. It supports multiple processor types, each designed to handle specific security log formats.</p>"},{"location":"#features","title":"Features","text":"<ul> <li>\ud83d\udd04 Transform Security Logs: Convert various security log formats into standardized security events</li> <li>\ud83c\udfaf Multiple Processors: Support for different security log sources (OpenReports, etc.)</li> <li>\ud83d\udcca Telemetry: Built-in metrics and logging for observability</li> <li>\ud83d\ude80 Easy Deployment: Docker and Kubernetes deployment options</li> <li>\u2699\ufe0f Flexible Configuration: Configurable filtering and field mapping</li> </ul>"},{"location":"#supported-processors","title":"Supported Processors","text":""},{"location":"#openreports-processor","title":"OpenReports Processor","text":"<p>Processes OpenReports Custom Resource logs from Kubernetes, transforming policy evaluation results into security events.</p> <p>Recommended Receiver: <code>k8sobjects</code> receiver</p> <p>Features: - Watches OpenReports Custom Resources in Kubernetes - Transforms each policy evaluation result into a separate security event - Configurable status filtering (pass, fail, error, skip) - Automatic Kubernetes workload identification</p>"},{"location":"#quick-start","title":"Quick Start","text":"<pre><code># Basic configuration\nreceivers:\n  k8sobjects:\n    auth_type: serviceAccount\n    objects:\n      - name: openreports\n        mode: watch\n        api_group: openreports.io\n        api_version: v1alpha1\n        resource: reports\n\nprocessors:\n  securityevent:\n    processors:\n      openreports:\n        enabled: true\n        status_filter:\n          - \"fail\"\n          - \"error\"\n\nservice:\n  pipelines:\n    logs:\n      receivers: [k8sobjects]\n      processors: [securityevent, batch]\n      exporters: [otlp]\n</code></pre>"},{"location":"#documentation-structure","title":"Documentation Structure","text":"<ul> <li>Getting Started: Learn the basics and get up and running</li> <li>Configuration: Configure processors, receivers, and exporters</li> <li>Deployment: Deploy using Docker or Kubernetes</li> <li>Processors: Detailed processor documentation</li> <li>Examples: Practical examples and use cases</li> </ul>"},{"location":"#need-help","title":"Need Help?","text":"<ul> <li>Check the Troubleshooting guide</li> <li>Review Examples for common configurations</li> <li>See Reference for detailed API documentation</li> </ul>"},{"location":"troubleshooting/","title":"Troubleshooting","text":"<p>Common issues and solutions for the Security Log Event Processor.</p>"},{"location":"troubleshooting/#collector-not-starting","title":"Collector Not Starting","text":""},{"location":"troubleshooting/#configuration-errors","title":"Configuration Errors","text":"<p>Symptoms: Collector fails to start with configuration errors</p> <p>Solutions: 1. Validate YAML syntax 2. Check required fields are present 3. Verify processor is enabled 4. Check receiver configuration</p> <pre><code># Test configuration\n./otelcol-securityevent --config=config.yaml --dry-run\n</code></pre>"},{"location":"troubleshooting/#missing-dependencies","title":"Missing Dependencies","text":"<p>Symptoms: Collector fails with \"component not found\" errors</p> <p>Solutions: 1. Rebuild collector with OCB 2. Verify manifest includes required components 3. Check component versions match</p>"},{"location":"troubleshooting/#no-events-generated","title":"No Events Generated","text":""},{"location":"troubleshooting/#processor-not-enabled","title":"Processor Not Enabled","text":"<p>Symptoms: Logs received but no security events generated</p> <p>Solutions: 1. Verify processor is enabled:    <pre><code>securityevent:\n  processors:\n    openreports:\n      enabled: true  # Must be true\n</code></pre></p> <ol> <li>Check status filter:    <pre><code>status_filter:\n  - \"fail\"  # Verify your logs have matching statuses\n</code></pre></li> </ol>"},{"location":"troubleshooting/#receiver-not-collecting","title":"Receiver Not Collecting","text":"<p>Symptoms: No logs received from receiver</p> <p>Solutions:</p> <p>k8sobjects receiver: - Verify OpenReports CRD exists: <code>kubectl get crd reports.openreports.io</code> - Check RBAC permissions - Verify namespace filters match actual namespaces - Check label selectors match resource labels</p> <p>OTLP receiver: - Verify endpoints are accessible - Check firewall rules - Verify client is sending to correct endpoint</p>"},{"location":"troubleshooting/#rbac-issues","title":"RBAC Issues","text":""},{"location":"troubleshooting/#permission-denied","title":"Permission Denied","text":"<p>Symptoms: \"forbidden\" or \"unauthorized\" errors in logs</p> <p>Solutions: 1. Verify ClusterRole exists:    <pre><code>kubectl get clusterrole otelcol-securityevent\n</code></pre></p> <ol> <li> <p>Verify ClusterRoleBinding exists:    <pre><code>kubectl get clusterrolebinding otelcol-securityevent\n</code></pre></p> </li> <li> <p>Test permissions:    <pre><code>kubectl auth can-i get reports -n default \\\n  --as=system:serviceaccount:otelcol-securityevent:otelcol-securityevent\n</code></pre></p> </li> <li> <p>Check ServiceAccount is configured in deployment</p> </li> </ol>"},{"location":"troubleshooting/#performance-issues","title":"Performance Issues","text":""},{"location":"troubleshooting/#high-memory-usage","title":"High Memory Usage","text":"<p>Symptoms: Collector using excessive memory</p> <p>Solutions: 1. Adjust memory limiter:    <pre><code>memory_limiter:\n  limit_mib: 2000  # Reduce limit\n</code></pre></p> <ol> <li> <p>Reduce batch size:    <pre><code>batch:\n  send_batch_size: 512  # Reduce batch size\n</code></pre></p> </li> <li> <p>Increase resource limits in Kubernetes</p> </li> </ol>"},{"location":"troubleshooting/#slow-processing","title":"Slow Processing","text":"<p>Symptoms: Events processed slowly</p> <p>Solutions: 1. Increase batch timeout:    <pre><code>batch:\n  timeout: 5s  # Increase timeout\n</code></pre></p> <ol> <li>Reduce status filter if processing too many events</li> <li>Scale up collector replicas</li> </ol>"},{"location":"troubleshooting/#debugging","title":"Debugging","text":""},{"location":"troubleshooting/#enable-debug-logging","title":"Enable Debug Logging","text":"<pre><code>exporters:\n  logging:\n    loglevel: debug\n</code></pre>"},{"location":"troubleshooting/#check-collector-logs","title":"Check Collector Logs","text":"<p>Docker: <pre><code>docker logs otelcol-securityevent\n</code></pre></p> <p>Kubernetes: <pre><code>kubectl logs -n otelcol-securityevent \\\n  -l app.kubernetes.io/name=otelcol-securityevent -f\n</code></pre></p>"},{"location":"troubleshooting/#check-health-endpoint","title":"Check Health Endpoint","text":"<pre><code>curl http://localhost:13133/\n</code></pre>"},{"location":"troubleshooting/#check-zpages","title":"Check zpages","text":"<pre><code># Port forward\nkubectl port-forward -n otelcol-securityevent \\\n  svc/otelcol-securityevent 55679:55679\n\n# Open in browser\nopen http://localhost:55679\n</code></pre>"},{"location":"troubleshooting/#common-error-messages","title":"Common Error Messages","text":""},{"location":"troubleshooting/#component-not-found","title":"\"component not found\"","text":"<p>Cause: Component not included in OCB manifest</p> <p>Solution: Rebuild collector with updated manifest</p>"},{"location":"troubleshooting/#permission-denied_1","title":"\"permission denied\"","text":"<p>Cause: Missing RBAC permissions</p> <p>Solution: Apply ClusterRole and ClusterRoleBinding</p>"},{"location":"troubleshooting/#no-matching-processor","title":"\"no matching processor\"","text":"<p>Cause: Log format doesn't match any processor</p> <p>Solution: Check log format matches expected format</p>"},{"location":"troubleshooting/#invalid-status-filter","title":"\"invalid status filter\"","text":"<p>Cause: Invalid status value in status_filter</p> <p>Solution: Use valid statuses: pass, fail, error, skip</p>"},{"location":"troubleshooting/#getting-help","title":"Getting Help","text":"<ol> <li>Check logs with debug level enabled</li> <li>Review configuration examples</li> <li>Check RBAC permissions</li> <li>Verify OpenReports CRD exists</li> <li>Review Examples</li> </ol>"},{"location":"troubleshooting/#next-steps","title":"Next Steps","text":"<ul> <li>Configuration Guide: Review configuration</li> <li>Examples: Review examples</li> <li>Reference: API reference</li> </ul>"},{"location":"configuration/exporters/","title":"Exporters Configuration","text":"<p>This guide explains how to configure exporters for the Security Log Event Processor.</p>"},{"location":"configuration/exporters/#overview","title":"Overview","text":"<p>Exporters send processed security events to various destinations. You can configure multiple exporters to send events to different systems.</p>"},{"location":"configuration/exporters/#common-exporters","title":"Common Exporters","text":""},{"location":"configuration/exporters/#otlp-exporter","title":"OTLP Exporter","text":"<p>Send events via OTLP protocol (recommended for most use cases).</p> <pre><code>exporters:\n  otlp:\n    endpoint: http://your-backend:4317\n    tls:\n      insecure: false\n      cert_file: /path/to/cert.pem\n      key_file: /path/to/key.pem\n</code></pre> <p>Configuration Options: - <code>endpoint</code>: OTLP endpoint URL - <code>tls.insecure</code>: Skip TLS verification (not recommended for production) - <code>tls.cert_file</code>: Client certificate file - <code>tls.key_file</code>: Client private key file</p>"},{"location":"configuration/exporters/#logging-exporter","title":"Logging Exporter","text":"<p>Output events to collector logs (useful for debugging).</p> <pre><code>exporters:\n  logging:\n    loglevel: info  # debug, info, warn, error\n</code></pre>"},{"location":"configuration/exporters/#otlp-http-exporter","title":"OTLP HTTP Exporter","text":"<p>Send events via OTLP over HTTP.</p> <pre><code>exporters:\n  otlphttp:\n    endpoint: http://your-backend:4318\n    tls:\n      insecure: false\n</code></pre>"},{"location":"configuration/exporters/#complete-example","title":"Complete Example","text":"<pre><code>exporters:\n  otlp:\n    endpoint: http://dynatrace-backend:4317\n    tls:\n      insecure: false\n\n  logging:\n    loglevel: info\n\nservice:\n  pipelines:\n    logs:\n      receivers: [k8sobjects]\n      processors: [securityevent, batch]\n      exporters: [otlp, logging]\n</code></pre>"},{"location":"configuration/exporters/#next-steps","title":"Next Steps","text":"<ul> <li>Processor Configuration: Configure processors</li> <li>Examples: Complete examples</li> </ul>"},{"location":"configuration/openreports/","title":"OpenReports Processor Configuration","text":"<p>Detailed configuration guide for the OpenReports processor.</p>"},{"location":"configuration/openreports/#overview","title":"Overview","text":"<p>The OpenReports processor transforms OpenReports Custom Resource logs into security events. Each policy evaluation result in an OpenReports log becomes a separate security event.</p>"},{"location":"configuration/openreports/#required-receiver","title":"Required Receiver","text":"<p>The OpenReports processor requires the k8sobjects receiver to collect OpenReports Custom Resources from Kubernetes.</p> <p>See Receivers Configuration for detailed receiver setup.</p>"},{"location":"configuration/openreports/#basic-configuration","title":"Basic Configuration","text":"<pre><code>processors:\n  securityevent:\n    processors:\n      openreports:\n        enabled: true\n</code></pre>"},{"location":"configuration/openreports/#configuration-options","title":"Configuration Options","text":""},{"location":"configuration/openreports/#enabled","title":"<code>enabled</code>","text":"<p>Enable or disable the OpenReports processor.</p> <p>Type: <code>boolean</code> Default: <code>false</code> Required: Yes</p> <pre><code>openreports:\n  enabled: true\n</code></pre>"},{"location":"configuration/openreports/#status_filter","title":"<code>status_filter</code>","text":"<p>Array of result statuses to process. Only results with statuses in this list will be transformed into security events.</p> <p>Type: <code>array of strings</code> Default: <code>[]</code> (all statuses) Required: No</p> <p>Valid Values: - <code>pass</code>: Policy evaluation passed - <code>fail</code>: Policy evaluation failed - <code>error</code>: Policy evaluation error - <code>skip</code>: Policy evaluation skipped</p> <pre><code>openreports:\n  enabled: true\n  status_filter:\n    - \"fail\"\n    - \"error\"\n</code></pre> <p>Examples:</p> <p>Process only failures: <pre><code>status_filter:\n  - \"fail\"\n</code></pre></p> <p>Process failures and errors: <pre><code>status_filter:\n  - \"fail\"\n  - \"error\"\n</code></pre></p> <p>Process all statuses (default): <pre><code># No status_filter specified, or empty array\nstatus_filter: []\n</code></pre></p>"},{"location":"configuration/openreports/#complete-configuration-example","title":"Complete Configuration Example","text":"<pre><code>receivers:\n  k8sobjects:\n    auth_type: serviceAccount\n    objects:\n      - name: openreports\n        mode: watch\n        api_group: openreports.io\n        api_version: v1alpha1\n        resource: reports\n\nprocessors:\n  securityevent:\n    processors:\n      openreports:\n        enabled: true\n        status_filter:\n          - \"fail\"\n          - \"error\"\n\nservice:\n  pipelines:\n    logs:\n      receivers: [k8sobjects]\n      processors: [securityevent, batch]\n      exporters: [otlp]\n</code></pre>"},{"location":"configuration/openreports/#field-mapping","title":"Field Mapping","text":"<p>The processor maps OpenReports fields to security event fields. See Field Mapping Reference for details.</p>"},{"location":"configuration/openreports/#key-mappings","title":"Key Mappings","text":"<ul> <li><code>result.policy</code> \u2192 <code>event.type</code></li> <li><code>result.rule</code> \u2192 <code>event.description</code></li> <li><code>result.status</code> \u2192 <code>compliance.status</code></li> <li><code>metadata.name</code> \u2192 <code>k8s.resource.name</code></li> <li><code>metadata.namespace</code> \u2192 <code>k8s.namespace.name</code></li> </ul>"},{"location":"configuration/openreports/#kubernetes-workload-identification","title":"Kubernetes Workload Identification","text":"<p>The processor automatically identifies Kubernetes workloads from: 1. <code>metadata.ownerReferences</code> (primary) 2. Pod name inference (fallback)</p> <p>Workload information is added to security events: - <code>k8s.workload.name</code> - <code>k8s.workload.kind</code> - <code>k8s.workload.uid</code> - <code>k8s.workload.namespace</code></p>"},{"location":"configuration/openreports/#output","title":"Output","text":"<p>Each OpenReports log with multiple results produces multiple security events:</p> <p>Input: 1 OpenReports log with 3 results Output: 3 security event logs</p>"},{"location":"configuration/openreports/#troubleshooting","title":"Troubleshooting","text":""},{"location":"configuration/openreports/#processor-not-processing-logs","title":"Processor Not Processing Logs","text":"<ol> <li> <p>Check if processor is enabled:    <pre><code>openreports:\n  enabled: true  # Must be true\n</code></pre></p> </li> <li> <p>Check status filter:    <pre><code># If status_filter is too restrictive, logs may be filtered out\nstatus_filter:\n  - \"fail\"  # Only processes failures\n</code></pre></p> </li> <li> <p>Check receiver configuration:</p> </li> <li>Verify k8sobjects receiver is configured</li> <li> <p>Verify receiver is in the pipeline</p> </li> <li> <p>Check logs:    <pre><code># Enable debug logging\nexporters:\n  logging:\n    loglevel: debug\n</code></pre></p> </li> </ol>"},{"location":"configuration/openreports/#no-security-events-generated","title":"No Security Events Generated","text":"<ul> <li>Check if OpenReports logs match the expected format</li> <li>Verify status_filter includes the statuses in your logs</li> <li>Check collector logs for processing errors</li> </ul>"},{"location":"configuration/openreports/#next-steps","title":"Next Steps","text":"<ul> <li>Receivers Configuration: Configure k8sobjects receiver</li> <li>Examples: Complete examples</li> <li>Field Mapping Reference: Detailed field mappings</li> </ul>"},{"location":"configuration/processor-config/","title":"Processor Configuration","text":"<p>This guide explains how to configure the Security Event Processor.</p>"},{"location":"configuration/processor-config/#basic-configuration","title":"Basic Configuration","text":"<p>The Security Event Processor is configured under the <code>processors</code> section:</p> <pre><code>processors:\n  securityevent:\n    processors:\n      openreports:\n        enabled: true\n        status_filter:\n          - \"fail\"\n          - \"error\"\n</code></pre>"},{"location":"configuration/processor-config/#processor-structure","title":"Processor Structure","text":"<pre><code>processors:\n  securityevent:\n    processors:\n      # Processor-specific configurations\n      openreports:\n        enabled: true\n        # Processor-specific options\n</code></pre>"},{"location":"configuration/processor-config/#openreports-processor-configuration","title":"OpenReports Processor Configuration","text":""},{"location":"configuration/processor-config/#basic-configuration_1","title":"Basic Configuration","text":"<pre><code>processors:\n  securityevent:\n    processors:\n      openreports:\n        enabled: true\n</code></pre>"},{"location":"configuration/processor-config/#status-filtering","title":"Status Filtering","text":"<p>Filter which result statuses should be processed:</p> <pre><code>processors:\n  securityevent:\n    processors:\n      openreports:\n        enabled: true\n        status_filter:\n          - \"fail\"    # Process failed policy evaluations\n          - \"error\"   # Process error statuses\n          # - \"pass\"  # Skip passing evaluations\n          # - \"skip\"  # Skip skipped evaluations\n</code></pre> <p>Valid Status Values: - <code>pass</code>: Policy evaluation passed - <code>fail</code>: Policy evaluation failed - <code>error</code>: Policy evaluation error - <code>skip</code>: Policy evaluation skipped</p> <p>If <code>status_filter</code> is empty or not specified, all statuses will be processed.</p>"},{"location":"configuration/processor-config/#complete-example","title":"Complete Example","text":"<pre><code>processors:\n  securityevent:\n    processors:\n      openreports:\n        enabled: true\n        status_filter:\n          - \"fail\"\n          - \"error\"\n</code></pre>"},{"location":"configuration/processor-config/#processor-in-pipeline","title":"Processor in Pipeline","text":"<p>The processor must be included in the service pipeline:</p> <pre><code>service:\n  pipelines:\n    logs:\n      receivers: [k8sobjects]\n      processors: [memory_limiter, securityevent, batch]\n      exporters: [otlp, logging]\n</code></pre> <p>Recommended Processor Order: 1. <code>memory_limiter</code> - Limit memory usage 2. <code>securityevent</code> - Transform security logs 3. <code>batch</code> - Batch events for efficiency</p>"},{"location":"configuration/processor-config/#configuration-validation","title":"Configuration Validation","text":"<p>The processor validates configuration at startup. Invalid configurations will cause the collector to fail to start.</p>"},{"location":"configuration/processor-config/#common-errors","title":"Common Errors","text":"<p>Processor not enabled: <pre><code># \u274c Wrong\nprocessors:\n  securityevent:\n    processors:\n      openreports:\n        enabled: false  # Processor won't process logs\n</code></pre></p> <p>Invalid status filter: <pre><code># \u274c Wrong\nprocessors:\n  securityevent:\n    processors:\n      openreports:\n        status_filter:\n          - \"invalid_status\"  # Will cause validation error\n</code></pre></p>"},{"location":"configuration/processor-config/#environment-variables","title":"Environment Variables","text":"<p>You can use environment variables in configuration:</p> <pre><code>processors:\n  securityevent:\n    processors:\n      openreports:\n        enabled: true\n        status_filter: ${OPENREPORTS_STATUS_FILTER:fail,error}\n</code></pre>"},{"location":"configuration/processor-config/#next-steps","title":"Next Steps","text":"<ul> <li>OpenReports Configuration: Detailed OpenReports configuration</li> <li>Receivers Configuration: Configure receivers for data collection</li> <li>Exporters Configuration: Configure exporters for data output</li> </ul>"},{"location":"configuration/receivers/","title":"Receivers Configuration","text":"<p>This guide explains which receivers to use with the Security Event Processor and how to configure them.</p>"},{"location":"configuration/receivers/#overview","title":"Overview","text":"<p>Receivers collect data from various sources. The processor you choose determines which receiver you need.</p>"},{"location":"configuration/receivers/#processor-receiver-mapping","title":"Processor-Receiver Mapping","text":"Processor Required Receiver Optional Receivers OpenReports <code>k8sobjects</code> <code>otlp</code>, <code>filelog</code>"},{"location":"configuration/receivers/#k8sobjects-receiver","title":"k8sobjects Receiver","text":"<p>Required for: OpenReports processor</p> <p>The k8sobjects receiver collects Kubernetes Custom Resources, making it ideal for collecting OpenReports logs.</p>"},{"location":"configuration/receivers/#basic-configuration","title":"Basic Configuration","text":"<pre><code>receivers:\n  k8sobjects:\n    auth_type: serviceAccount\n    objects:\n      - name: openreports\n        mode: watch\n        api_group: openreports.io\n        api_version: v1alpha1\n        resource: reports\n</code></pre>"},{"location":"configuration/receivers/#configuration-options","title":"Configuration Options","text":""},{"location":"configuration/receivers/#auth_type","title":"<code>auth_type</code>","text":"<p>Authentication type for Kubernetes API access.</p> <p>Type: <code>string</code> Default: <code>serviceAccount</code> Required: Yes</p> <p>Valid Values: - <code>serviceAccount</code>: Use Kubernetes ServiceAccount (recommended for production) - <code>kubeConfig</code>: Use kubeconfig file</p> <pre><code>k8sobjects:\n  auth_type: serviceAccount\n</code></pre>"},{"location":"configuration/receivers/#objects","title":"<code>objects</code>","text":"<p>Array of Kubernetes objects to collect.</p> <p>Type: <code>array</code> Required: Yes</p> <p>Each object configuration:</p> <pre><code>objects:\n  - name: &lt;unique-name&gt;\n    mode: &lt;watch|pull&gt;\n    api_group: &lt;api-group&gt;\n    api_version: &lt;api-version&gt;\n    resource: &lt;resource-name&gt;\n    # Optional filters\n    namespaces: [&lt;namespace-list&gt;]\n    label_selector: &lt;label-selector&gt;\n    field_selector: &lt;field-selector&gt;\n</code></pre> <p>Fields:</p> <ul> <li><code>name</code>: Unique identifier for this object collection</li> <li><code>mode</code>: Collection mode</li> <li><code>watch</code>: Watch for changes (real-time)</li> <li><code>pull</code>: Periodically pull objects</li> <li><code>api_group</code>: Kubernetes API group (e.g., <code>openreports.io</code>)</li> <li><code>api_version</code>: API version (e.g., <code>v1alpha1</code>)</li> <li><code>resource</code>: Resource name (e.g., <code>reports</code>)</li> <li><code>namespaces</code>: (Optional) List of namespaces to watch</li> <li><code>label_selector</code>: (Optional) Label selector filter</li> <li><code>field_selector</code>: (Optional) Field selector filter</li> </ul>"},{"location":"configuration/receivers/#openreports-configuration","title":"OpenReports Configuration","text":"<pre><code>receivers:\n  k8sobjects:\n    auth_type: serviceAccount\n    objects:\n      - name: openreports\n        mode: watch\n        api_group: openreports.io\n        api_version: v1alpha1\n        resource: reports\n        # Optional: Filter by namespace\n        namespaces: [default, production]\n        # Optional: Filter by labels\n        label_selector: environment in (production,staging)\n</code></pre>"},{"location":"configuration/receivers/#namespace-filtering","title":"Namespace Filtering","text":"<p>Watch OpenReports in specific namespaces:</p> <pre><code>objects:\n  - name: openreports\n    mode: watch\n    api_group: openreports.io\n    api_version: v1alpha1\n    resource: reports\n    namespaces: [default, production, staging]\n</code></pre>"},{"location":"configuration/receivers/#label-selector-filtering","title":"Label Selector Filtering","text":"<p>Filter by labels:</p> <pre><code>objects:\n  - name: openreports\n    mode: watch\n    api_group: openreports.io\n    api_version: v1alpha1\n    resource: reports\n    label_selector: environment in (production,staging)\n</code></pre>"},{"location":"configuration/receivers/#kubernetes-rbac-requirements","title":"Kubernetes RBAC Requirements","text":"<p>The k8sobjects receiver requires RBAC permissions. See RBAC Setup for details.</p> <p>Required Permissions: - <code>get</code>, <code>list</code>, <code>watch</code> on <code>reports</code> resource in <code>openreports.io</code> API group</p>"},{"location":"configuration/receivers/#otlp-receiver","title":"OTLP Receiver","text":"<p>Optional: Can be used alongside k8sobjects for receiving logs via OTLP protocol</p> <pre><code>receivers:\n  otlp:\n    protocols:\n      grpc:\n        endpoint: 0.0.0.0:4317\n      http:\n        endpoint: 0.0.0.0:4318\n</code></pre> <p>Useful for: - Receiving logs from other collectors - Testing with OTLP clients - Receiving logs from applications</p>"},{"location":"configuration/receivers/#filelog-receiver","title":"filelog Receiver","text":"<p>Optional: Can be used for reading OpenReports logs from files</p> <pre><code>receivers:\n  filelog:\n    include:\n      - /var/log/openreports/*.log\n    exclude: []\n    start_at: end\n</code></pre>"},{"location":"configuration/receivers/#complete-example","title":"Complete Example","text":"<pre><code>receivers:\n  # Primary receiver for OpenReports\n  k8sobjects:\n    auth_type: serviceAccount\n    objects:\n      - name: openreports\n        mode: watch\n        api_group: openreports.io\n        api_version: v1alpha1\n        resource: reports\n\n  # Optional: OTLP receiver for additional log sources\n  otlp:\n    protocols:\n      grpc:\n        endpoint: 0.0.0.0:4317\n      http:\n        endpoint: 0.0.0.0:4318\n\nprocessors:\n  securityevent:\n    processors:\n      openreports:\n        enabled: true\n\nservice:\n  pipelines:\n    logs:\n      receivers: [k8sobjects, otlp]\n      processors: [securityevent, batch]\n      exporters: [otlp]\n</code></pre>"},{"location":"configuration/receivers/#troubleshooting","title":"Troubleshooting","text":""},{"location":"configuration/receivers/#k8sobjects-receiver-issues","title":"k8sobjects Receiver Issues","text":"<p>\"Permission denied\" errors: - Check RBAC permissions (ClusterRole, ClusterRoleBinding) - Verify ServiceAccount is configured - See RBAC Setup</p> <p>No logs received: - Verify OpenReports CRD exists: <code>kubectl get crd reports.openreports.io</code> - Check namespace filters match actual namespaces - Verify label selectors match resource labels - Enable debug logging: <code>loglevel: debug</code></p> <p>Receiver not starting: - Check API group/version/resource are correct - Verify authentication is configured - Check collector logs for errors</p>"},{"location":"configuration/receivers/#next-steps","title":"Next Steps","text":"<ul> <li>RBAC Setup: Configure Kubernetes permissions</li> <li>OpenReports Configuration: Configure OpenReports processor</li> <li>Examples: Complete examples</li> </ul>"},{"location":"deployment/docker/","title":"Docker Deployment","text":"<p>Deploy the Security Log Event Processor using Docker.</p>"},{"location":"deployment/docker/#prerequisites","title":"Prerequisites","text":"<ul> <li>Docker installed</li> <li>OpenReports CRD installed in your Kubernetes cluster (if using k8sobjects receiver)</li> </ul>"},{"location":"deployment/docker/#build-docker-image","title":"Build Docker Image","text":"<pre><code># Build the image\nmake docker-build\n\n# Or using docker-compose\ndocker-compose -f docker/docker-compose.yml build\n</code></pre>"},{"location":"deployment/docker/#run-container","title":"Run Container","text":""},{"location":"deployment/docker/#basic-run","title":"Basic Run","text":"<pre><code>docker run -d \\\n  --name otelcol-securityevent \\\n  -p 4317:4317 \\\n  -p 4318:4318 \\\n  -p 13133:13133 \\\n  -v $(pwd)/config.yaml:/etc/otelcol/config.yaml:ro \\\n  otelcol-securityevent:latest\n</code></pre>"},{"location":"deployment/docker/#using-docker-compose","title":"Using Docker Compose","text":"<pre><code># Start services\ndocker-compose -f docker/docker-compose.yml up -d\n\n# View logs\ndocker-compose -f docker/docker-compose.yml logs -f\n\n# Stop services\ndocker-compose -f docker/docker-compose.yml down\n</code></pre>"},{"location":"deployment/docker/#configuration","title":"Configuration","text":"<p>Mount your configuration file:</p> <pre><code>docker run -v /path/to/config.yaml:/etc/otelcol/config.yaml:ro \\\n  otelcol-securityevent:latest\n</code></pre>"},{"location":"deployment/docker/#ports","title":"Ports","text":"<ul> <li><code>4317</code>: OTLP gRPC receiver</li> <li><code>4318</code>: OTLP HTTP receiver</li> <li><code>13133</code>: Health check endpoint</li> <li><code>55679</code>: zpages extension</li> <li><code>1777</code>: pprof extension</li> </ul>"},{"location":"deployment/docker/#health-check","title":"Health Check","text":"<pre><code>curl http://localhost:13133/\n</code></pre>"},{"location":"deployment/docker/#logs","title":"Logs","text":"<pre><code># View logs\ndocker logs otelcol-securityevent\n\n# Follow logs\ndocker logs -f otelcol-securityevent\n</code></pre>"},{"location":"deployment/docker/#environment-variables","title":"Environment Variables","text":"<p>Set environment variables:</p> <pre><code>docker run -e OTEL_LOG_LEVEL=debug \\\n  otelcol-securityevent:latest\n</code></pre>"},{"location":"deployment/docker/#limitations","title":"Limitations","text":"<p>Note: Docker deployment cannot use the k8sobjects receiver directly because it requires Kubernetes API access. For k8sobjects receiver, use Kubernetes deployment.</p> <p>For Docker, you can: - Use OTLP receiver to receive logs from other sources - Use filelog receiver to read logs from mounted volumes - Run in Kubernetes-in-Docker (kind, minikube) for local development</p>"},{"location":"deployment/docker/#next-steps","title":"Next Steps","text":"<ul> <li>Kubernetes Deployment: Deploy to Kubernetes for k8sobjects support</li> <li>Configuration Guide: Configure the processor</li> </ul>"},{"location":"deployment/kubernetes/","title":"Kubernetes Deployment","text":"<p>Deploy the Security Log Event Processor to Kubernetes.</p>"},{"location":"deployment/kubernetes/#prerequisites","title":"Prerequisites","text":"<ul> <li>Kubernetes cluster (v1.19+)</li> <li><code>kubectl</code> configured</li> <li>OpenReports CRD installed</li> <li>Container registry access (for pushing images)</li> </ul>"},{"location":"deployment/kubernetes/#quick-start","title":"Quick Start","text":"<pre><code># Apply all manifests\nkubectl apply -f k8s/\n\n# Or using kustomize\nkubectl apply -k k8s/\n</code></pre>"},{"location":"deployment/kubernetes/#build-and-push-image","title":"Build and Push Image","text":"<pre><code># Build the image\nmake docker-build\n\n# Tag for your registry\ndocker tag otelcol-securityevent:latest \\\n  your-registry/otelcol-securityevent:0.1.0\n\n# Push to registry\ndocker push your-registry/otelcol-securityevent:0.1.0\n</code></pre>"},{"location":"deployment/kubernetes/#update-image-in-deployment","title":"Update Image in Deployment","text":"<p>Edit <code>k8s/deployment.yaml</code>:</p> <pre><code>containers:\n- name: otelcol\n  image: your-registry/otelcol-securityevent:0.1.0\n  imagePullPolicy: IfNotPresent\n</code></pre>"},{"location":"deployment/kubernetes/#verify-deployment","title":"Verify Deployment","text":"<pre><code># Check pods\nkubectl get pods -n otelcol-securityevent\n\n# Check services\nkubectl get svc -n otelcol-securityevent\n\n# View logs\nkubectl logs -n otelcol-securityevent \\\n  -l app.kubernetes.io/name=otelcol-securityevent -f\n</code></pre>"},{"location":"deployment/kubernetes/#configuration","title":"Configuration","text":""},{"location":"deployment/kubernetes/#update-configmap","title":"Update ConfigMap","text":"<p>Edit <code>k8s/configmap.yaml</code> to customize configuration:</p> <pre><code>data:\n  config.yaml: |\n    receivers:\n      k8sobjects:\n        # Your configuration\n    processors:\n      securityevent:\n        # Your configuration\n</code></pre> <p>Apply changes:</p> <pre><code>kubectl apply -f k8s/configmap.yaml\nkubectl rollout restart deployment/otelcol-securityevent -n otelcol-securityevent\n</code></pre>"},{"location":"deployment/kubernetes/#environment-variables","title":"Environment Variables","text":"<p>Set environment variables in <code>k8s/deployment.yaml</code>:</p> <pre><code>env:\n- name: OTEL_LOG_LEVEL\n  value: \"debug\"\n</code></pre>"},{"location":"deployment/kubernetes/#rbac","title":"RBAC","text":"<p>The deployment includes RBAC resources for k8sobjects receiver. See RBAC Setup for details.</p>"},{"location":"deployment/kubernetes/#scaling","title":"Scaling","text":""},{"location":"deployment/kubernetes/#manual-scaling","title":"Manual Scaling","text":"<pre><code>kubectl scale deployment otelcol-securityevent \\\n  -n otelcol-securityevent --replicas=3\n</code></pre>"},{"location":"deployment/kubernetes/#horizontal-pod-autoscaler","title":"Horizontal Pod Autoscaler","text":"<p>Create an HPA:</p> <pre><code>apiVersion: autoscaling/v2\nkind: HorizontalPodAutoscaler\nmetadata:\n  name: otelcol-securityevent-hpa\n  namespace: otelcol-securityevent\nspec:\n  scaleTargetRef:\n    apiVersion: apps/v1\n    kind: Deployment\n    name: otelcol-securityevent\n  minReplicas: 2\n  maxReplicas: 10\n  metrics:\n  - type: Resource\n    resource:\n      name: cpu\n      target:\n        type: Utilization\n        averageUtilization: 70\n</code></pre>"},{"location":"deployment/kubernetes/#monitoring","title":"Monitoring","text":""},{"location":"deployment/kubernetes/#health-check","title":"Health Check","text":"<pre><code># Port forward\nkubectl port-forward -n otelcol-securityevent \\\n  svc/otelcol-securityevent 13133:13133\n\n# Check health\ncurl http://localhost:13133/\n</code></pre>"},{"location":"deployment/kubernetes/#metrics","title":"Metrics","text":"<p>The collector exposes metrics on the health check endpoint. Configure Prometheus ServiceMonitor if using Prometheus Operator.</p>"},{"location":"deployment/kubernetes/#troubleshooting","title":"Troubleshooting","text":""},{"location":"deployment/kubernetes/#pod-not-starting","title":"Pod Not Starting","text":"<pre><code># Check pod events\nkubectl describe pod -n otelcol-securityevent &lt;pod-name&gt;\n\n# Check logs\nkubectl logs -n otelcol-securityevent &lt;pod-name&gt;\n</code></pre>"},{"location":"deployment/kubernetes/#rbac-issues","title":"RBAC Issues","text":"<pre><code># Check RBAC\nkubectl get clusterrole otelcol-securityevent\nkubectl get clusterrolebinding otelcol-securityevent\n\n# Test permissions\nkubectl auth can-i get reports -n default \\\n  --as=system:serviceaccount:otelcol-securityevent:otelcol-securityevent\n</code></pre>"},{"location":"deployment/kubernetes/#next-steps","title":"Next Steps","text":"<ul> <li>RBAC Setup: Configure RBAC permissions</li> <li>Configuration Guide: Configure the processor</li> </ul>"},{"location":"deployment/overview/","title":"Deployment Overview","text":"<p>This guide explains deployment options for the Security Log Event Processor.</p>"},{"location":"deployment/overview/#deployment-methods","title":"Deployment Methods","text":"<p>The Security Log Event Processor can be deployed using:</p> <ol> <li>Docker: Containerized deployment for local development and production</li> <li>Kubernetes: Native Kubernetes deployment with full RBAC support</li> </ol>"},{"location":"deployment/overview/#choosing-a-deployment-method","title":"Choosing a Deployment Method","text":""},{"location":"deployment/overview/#use-docker-if","title":"Use Docker If:","text":"<ul> <li>Local development and testing</li> <li>Simple deployment scenarios</li> <li>Single-host deployment</li> <li>CI/CD pipelines</li> </ul>"},{"location":"deployment/overview/#use-kubernetes-if","title":"Use Kubernetes If:","text":"<ul> <li>Production deployments</li> <li>Need high availability</li> <li>Multi-cluster deployments</li> <li>Need RBAC integration for k8sobjects receiver</li> </ul>"},{"location":"deployment/overview/#common-requirements","title":"Common Requirements","text":"<p>Regardless of deployment method, you'll need:</p> <ol> <li>OpenReports CRD: The OpenReports Custom Resource Definition must be installed</li> <li>Configuration: Collector configuration file</li> <li>RBAC (for Kubernetes): ClusterRole and ClusterRoleBinding for k8sobjects receiver</li> </ol>"},{"location":"deployment/overview/#quick-comparison","title":"Quick Comparison","text":"Feature Docker Kubernetes Setup Complexity Low Medium RBAC Support No Yes High Availability Manual Built-in Scaling Manual Automatic (HPA) Resource Management Manual Automatic Best For Development Production"},{"location":"deployment/overview/#next-steps","title":"Next Steps","text":"<ul> <li>Docker Deployment: Deploy using Docker</li> <li>Kubernetes Deployment: Deploy to Kubernetes</li> <li>RBAC Setup: Configure RBAC permissions</li> </ul>"},{"location":"deployment/rbac/","title":"RBAC Setup","text":"<p>Configure RBAC permissions for the k8sobjects receiver.</p>"},{"location":"deployment/rbac/#overview","title":"Overview","text":"<p>The k8sobjects receiver requires Kubernetes RBAC permissions to access OpenReports Custom Resources. The deployment includes ClusterRole and ClusterRoleBinding resources.</p>"},{"location":"deployment/rbac/#required-permissions","title":"Required Permissions","text":"<p>The collector needs the following permissions:</p> <ul> <li><code>get</code>, <code>list</code>, <code>watch</code> on <code>reports</code> resource in <code>openreports.io</code> API group</li> </ul>"},{"location":"deployment/rbac/#included-rbac-resources","title":"Included RBAC Resources","text":"<p>The Kubernetes manifests include:</p> <ol> <li>ServiceAccount (<code>k8s/serviceaccount.yaml</code>): Service account for the collector</li> <li>ClusterRole (<code>k8s/clusterrole.yaml</code>): Defines permissions</li> <li>ClusterRoleBinding (<code>k8s/clusterrolebinding.yaml</code>): Binds permissions to ServiceAccount</li> </ol>"},{"location":"deployment/rbac/#clusterrole","title":"ClusterRole","text":"<pre><code>apiVersion: rbac.authorization.k8s.io/v1\nkind: ClusterRole\nmetadata:\n  name: otelcol-securityevent\nrules:\n  - apiGroups: [\"openreports.io\"]\n    resources: [\"reports\"]\n    verbs: [\"get\", \"list\", \"watch\"]\n</code></pre>"},{"location":"deployment/rbac/#clusterrolebinding","title":"ClusterRoleBinding","text":"<pre><code>apiVersion: rbac.authorization.k8s.io/v1\nkind: ClusterRoleBinding\nmetadata:\n  name: otelcol-securityevent\nroleRef:\n  apiGroup: rbac.authorization.k8s.io\n  kind: ClusterRole\n  name: otelcol-securityevent\nsubjects:\n  - kind: ServiceAccount\n    name: otelcol-securityevent\n    namespace: otelcol-securityevent\n</code></pre>"},{"location":"deployment/rbac/#verification","title":"Verification","text":""},{"location":"deployment/rbac/#check-rbac-resources","title":"Check RBAC Resources","text":"<pre><code># Check ClusterRole\nkubectl get clusterrole otelcol-securityevent\n\n# Check ClusterRoleBinding\nkubectl get clusterrolebinding otelcol-securityevent\n\n# Check ServiceAccount\nkubectl get serviceaccount otelcol-securityevent -n otelcol-securityevent\n</code></pre>"},{"location":"deployment/rbac/#test-permissions","title":"Test Permissions","text":"<pre><code># Test get permission\nkubectl auth can-i get reports -n default \\\n  --as=system:serviceaccount:otelcol-securityevent:otelcol-securityevent\n\n# Test list permission\nkubectl auth can-i list reports -n default \\\n  --as=system:serviceaccount:otelcol-securityevent:otelcol-securityevent\n\n# Test watch permission\nkubectl auth can-i watch reports -n default \\\n  --as=system:serviceaccount:otelcol-securityevent:otelcol-securityevent\n</code></pre> <p>All commands should return <code>yes</code>.</p>"},{"location":"deployment/rbac/#custom-permissions","title":"Custom Permissions","text":""},{"location":"deployment/rbac/#additional-resources","title":"Additional Resources","text":"<p>To collect additional Kubernetes resources, add to ClusterRole:</p> <pre><code>rules:\n  - apiGroups: [\"openreports.io\"]\n    resources: [\"reports\"]\n    verbs: [\"get\", \"list\", \"watch\"]\n  # Additional resources\n  - apiGroups: [\"\"]\n    resources: [\"events\", \"pods\"]\n    verbs: [\"get\", \"list\", \"watch\"]\n</code></pre>"},{"location":"deployment/rbac/#namespace-scoped-permissions","title":"Namespace-Scoped Permissions","text":"<p>If you only need namespace-scoped permissions, use Role and RoleBinding instead:</p> <pre><code>apiVersion: rbac.authorization.k8s.io/v1\nkind: Role\nmetadata:\n  name: otelcol-securityevent\n  namespace: &lt;namespace&gt;\nrules:\n  - apiGroups: [\"openreports.io\"]\n    resources: [\"reports\"]\n    verbs: [\"get\", \"list\", \"watch\"]\n</code></pre>"},{"location":"deployment/rbac/#troubleshooting","title":"Troubleshooting","text":""},{"location":"deployment/rbac/#permission-denied-errors","title":"Permission Denied Errors","text":"<p>If you see permission denied errors:</p> <ol> <li> <p>Verify RBAC resources exist:    <pre><code>kubectl get clusterrole otelcol-securityevent\nkubectl get clusterrolebinding otelcol-securityevent\n</code></pre></p> </li> <li> <p>Check ServiceAccount:    <pre><code>kubectl get pod -n otelcol-securityevent \\\n  -o jsonpath='{.items[0].spec.serviceAccountName}'\n</code></pre></p> </li> <li> <p>Test permissions manually (see above)</p> </li> <li> <p>Check OpenReports CRD exists:    <pre><code>kubectl get crd reports.openreports.io\n</code></pre></p> </li> </ol>"},{"location":"deployment/rbac/#collector-logs","title":"Collector Logs","text":"<p>Check collector logs for RBAC errors:</p> <pre><code>kubectl logs -n otelcol-securityevent \\\n  -l app.kubernetes.io/name=otelcol-securityevent | grep -i \"permission\\|forbidden\\|unauthorized\"\n</code></pre>"},{"location":"deployment/rbac/#next-steps","title":"Next Steps","text":"<ul> <li>Kubernetes Deployment: Complete deployment guide</li> <li>k8sobjects Receiver: Receiver configuration</li> </ul>"},{"location":"examples/basic/","title":"Basic Example","text":"<p>Basic example configuration for the Security Log Event Processor.</p>"},{"location":"examples/basic/#minimal-configuration","title":"Minimal Configuration","text":"<pre><code>receivers:\n  k8sobjects:\n    auth_type: serviceAccount\n    objects:\n      - name: openreports\n        mode: watch\n        api_group: openreports.io\n        api_version: v1alpha1\n        resource: reports\n\nprocessors:\n  securityevent:\n    processors:\n      openreports:\n        enabled: true\n\nexporters:\n  logging:\n    loglevel: info\n\nservice:\n  pipelines:\n    logs:\n      receivers: [k8sobjects]\n      processors: [securityevent]\n      exporters: [logging]\n</code></pre>"},{"location":"examples/basic/#with-status-filtering","title":"With Status Filtering","text":"<pre><code>processors:\n  securityevent:\n    processors:\n      openreports:\n        enabled: true\n        status_filter:\n          - \"fail\"\n          - \"error\"\n</code></pre>"},{"location":"examples/basic/#with-otlp-exporter","title":"With OTLP Exporter","text":"<pre><code>exporters:\n  otlp:\n    endpoint: http://your-backend:4317\n\nservice:\n  pipelines:\n    logs:\n      receivers: [k8sobjects]\n      processors: [securityevent, batch]\n      exporters: [otlp]\n</code></pre>"},{"location":"examples/basic/#next-steps","title":"Next Steps","text":"<ul> <li>OpenReports Example: Complete example</li> <li>Configuration Guide: Configuration options</li> </ul>"},{"location":"examples/multi-processor/","title":"Multi-Processor Example","text":"<p>Example configuration using multiple processors (when available).</p>"},{"location":"examples/multi-processor/#overview","title":"Overview","text":"<p>This example shows how to configure multiple processors. Currently, only OpenReports processor is available, but this structure supports future processors.</p>"},{"location":"examples/multi-processor/#configuration","title":"Configuration","text":"<pre><code>receivers:\n  k8sobjects:\n    auth_type: serviceAccount\n    objects:\n      - name: openreports\n        mode: watch\n        api_group: openreports.io\n        api_version: v1alpha1\n        resource: reports\n\n  otlp:\n    protocols:\n      grpc:\n        endpoint: 0.0.0.0:4317\n\nprocessors:\n  securityevent:\n    processors:\n      openreports:\n        enabled: true\n        status_filter:\n          - \"fail\"\n          - \"error\"\n      # Future processors will be added here\n\nexporters:\n  otlp:\n    endpoint: http://your-backend:4317\n\nservice:\n  pipelines:\n    logs:\n      receivers: [k8sobjects, otlp]\n      processors: [securityevent, batch]\n      exporters: [otlp]\n</code></pre>"},{"location":"examples/multi-processor/#processor-priority","title":"Processor Priority","text":"<p>Processors are checked in order. The first matching processor processes the log.</p>"},{"location":"examples/multi-processor/#next-steps","title":"Next Steps","text":"<ul> <li>Processors Overview: Available processors</li> <li>Configuration Guide: Configuration options</li> </ul>"},{"location":"examples/openreports-k8sobjects/","title":"OpenReports with k8sobjects Receiver","text":"<p>Complete example configuration for OpenReports processor with k8sobjects receiver.</p>"},{"location":"examples/openreports-k8sobjects/#overview","title":"Overview","text":"<p>This example shows how to: 1. Configure k8sobjects receiver to collect OpenReports Custom Resources 2. Configure OpenReports processor to transform logs 3. Export security events via OTLP</p>"},{"location":"examples/openreports-k8sobjects/#complete-configuration","title":"Complete Configuration","text":"<pre><code>receivers:\n  # k8sobjects receiver - collects OpenReports Custom Resources\n  k8sobjects:\n    auth_type: serviceAccount\n    objects:\n      - name: openreports\n        mode: watch\n        api_group: openreports.io\n        api_version: v1alpha1\n        resource: reports\n        # Optional: Filter by namespace\n        namespaces: [default, production]\n        # Optional: Filter by labels\n        label_selector: environment in (production,staging)\n\nprocessors:\n  batch:\n    timeout: 1s\n    send_batch_size: 1024\n\n  memory_limiter:\n    check_interval: 1s\n    limit_mib: 4000\n\n  # Security Event Processor\n  securityevent:\n    processors:\n      openreports:\n        enabled: true\n        status_filter:\n          - \"fail\"\n          - \"error\"\n\nexporters:\n  otlp:\n    endpoint: http://your-backend:4317\n    tls:\n      insecure: false\n\n  logging:\n    loglevel: info\n\nservice:\n  pipelines:\n    logs:\n      receivers: [k8sobjects]\n      processors: [memory_limiter, securityevent, batch]\n      exporters: [otlp, logging]\n\n  extensions: [health_check, pprof, zpages]\n\nextensions:\n  health_check:\n    endpoint: 0.0.0.0:13133\n  pprof:\n    endpoint: 0.0.0.0:1777\n  zpages:\n    endpoint: 0.0.0.0:55679\n</code></pre>"},{"location":"examples/openreports-k8sobjects/#kubernetes-deployment","title":"Kubernetes Deployment","text":""},{"location":"examples/openreports-k8sobjects/#1-apply-rbac","title":"1. Apply RBAC","text":"<pre><code>kubectl apply -f k8s/namespace.yaml\nkubectl apply -f k8s/serviceaccount.yaml\nkubectl apply -f k8s/clusterrole.yaml\nkubectl apply -f k8s/clusterrolebinding.yaml\n</code></pre>"},{"location":"examples/openreports-k8sobjects/#2-create-configmap","title":"2. Create ConfigMap","text":"<pre><code>kubectl create configmap otelcol-securityevent-config \\\n  --from-file=config.yaml=config.yaml \\\n  -n otelcol-securityevent\n</code></pre>"},{"location":"examples/openreports-k8sobjects/#3-deploy-collector","title":"3. Deploy Collector","text":"<pre><code>kubectl apply -f k8s/deployment.yaml\nkubectl apply -f k8s/service.yaml\n</code></pre>"},{"location":"examples/openreports-k8sobjects/#verification","title":"Verification","text":""},{"location":"examples/openreports-k8sobjects/#check-pods","title":"Check Pods","text":"<pre><code>kubectl get pods -n otelcol-securityevent\n</code></pre>"},{"location":"examples/openreports-k8sobjects/#check-logs","title":"Check Logs","text":"<pre><code>kubectl logs -n otelcol-securityevent \\\n  -l app.kubernetes.io/name=otelcol-securityevent -f\n</code></pre> <p>You should see logs indicating: - k8sobjects receiver started - OpenReports processor enabled - Security events being generated</p>"},{"location":"examples/openreports-k8sobjects/#check-health","title":"Check Health","text":"<pre><code>kubectl port-forward -n otelcol-securityevent \\\n  svc/otelcol-securityevent 13133:13133\n\ncurl http://localhost:13133/\n</code></pre>"},{"location":"examples/openreports-k8sobjects/#expected-output","title":"Expected Output","text":"<p>When an OpenReports Custom Resource is created/updated, you should see:</p> <ol> <li>k8sobjects receiver collects the resource</li> <li>OpenReports processor transforms each result into a security event</li> <li>Exporter sends events to configured backend</li> </ol>"},{"location":"examples/openreports-k8sobjects/#example-security-event","title":"Example Security Event","text":"<pre><code>{\n  \"event\": {\n    \"id\": \"550e8400-e29b-41d4-a716-446655440000\",\n    \"type\": \"pod-security-policy\",\n    \"description\": \"no-privileged-containers\",\n    \"timestamp\": \"2024-01-15T10:30:00Z\"\n  },\n  \"dt.security.risk.level\": \"HIGH\",\n  \"dt.security.risk.score\": 8.5,\n  \"compliance.status\": \"NON_COMPLIANT\",\n  \"k8s\": {\n    \"namespace.name\": \"production\",\n    \"resource.name\": \"security-scan-001\",\n    \"workload.name\": \"my-app\",\n    \"workload.kind\": \"Deployment\",\n    \"workload.uid\": \"12345678-1234-1234-1234-123456789012\"\n  }\n}\n</code></pre>"},{"location":"examples/openreports-k8sobjects/#customization","title":"Customization","text":""},{"location":"examples/openreports-k8sobjects/#filter-by-namespace","title":"Filter by Namespace","text":"<pre><code>k8sobjects:\n  objects:\n    - name: openreports\n      namespaces: [production, staging]\n</code></pre>"},{"location":"examples/openreports-k8sobjects/#filter-by-labels","title":"Filter by Labels","text":"<pre><code>k8sobjects:\n  objects:\n    - name: openreports\n      label_selector: environment=production\n</code></pre>"},{"location":"examples/openreports-k8sobjects/#process-all-statuses","title":"Process All Statuses","text":"<pre><code>securityevent:\n  processors:\n    openreports:\n      enabled: true\n      # No status_filter = process all statuses\n</code></pre>"},{"location":"examples/openreports-k8sobjects/#troubleshooting","title":"Troubleshooting","text":""},{"location":"examples/openreports-k8sobjects/#no-events-received","title":"No Events Received","text":"<ol> <li> <p>Check OpenReports CRD exists:    <pre><code>kubectl get crd reports.openreports.io\n</code></pre></p> </li> <li> <p>Verify RBAC permissions:    <pre><code>kubectl auth can-i get reports -n default \\\n  --as=system:serviceaccount:otelcol-securityevent:otelcol-securityevent\n</code></pre></p> </li> <li> <p>Check collector logs for errors</p> </li> </ol>"},{"location":"examples/openreports-k8sobjects/#events-not-generated","title":"Events Not Generated","text":"<ol> <li>Verify processor is enabled</li> <li>Check status_filter matches your result statuses</li> <li>Enable debug logging</li> </ol>"},{"location":"examples/openreports-k8sobjects/#next-steps","title":"Next Steps","text":"<ul> <li>Configuration Guide: Detailed configuration</li> <li>RBAC Setup: RBAC configuration</li> <li>Field Mapping: Field mappings</li> </ul>"},{"location":"getting-started/installation/","title":"Installation","text":"<p>This guide explains how to install and set up the Security Log Event Processor.</p>"},{"location":"getting-started/installation/#prerequisites","title":"Prerequisites","text":"<ul> <li>OpenTelemetry Collector (v0.138.0 or later)</li> <li>Go 1.21+ (if building from source)</li> <li>Docker (for containerized deployment)</li> <li>Kubernetes cluster (for Kubernetes deployment)</li> </ul>"},{"location":"getting-started/installation/#installation-methods","title":"Installation Methods","text":""},{"location":"getting-started/installation/#option-1-using-pre-built-collector-recommended","title":"Option 1: Using Pre-built Collector (Recommended)","text":"<p>Build the collector using OpenTelemetry Collector Builder (OCB) with the included manifest:</p> <pre><code># Clone the repository\ngit clone https://github.com/dynatrace/securitylogeventprocessor.git\ncd securitylogeventprocessor\n\n# Build using OCB\nmake ocb-build\n</code></pre> <p>The collector binary will be available at <code>dist/otelcol-securityevent</code>.</p>"},{"location":"getting-started/installation/#option-2-docker-image","title":"Option 2: Docker Image","text":"<p>Build the Docker image:</p> <pre><code># Build Docker image\nmake docker-build\n\n# Or using docker-compose\ndocker-compose -f docker/docker-compose.yml build\n</code></pre>"},{"location":"getting-started/installation/#option-3-kubernetes-deployment","title":"Option 3: Kubernetes Deployment","text":"<p>Deploy to Kubernetes:</p> <pre><code># Apply Kubernetes manifests\nkubectl apply -f k8s/\n\n# Or using kustomize\nkubectl apply -k k8s/\n</code></pre>"},{"location":"getting-started/installation/#verify-installation","title":"Verify Installation","text":""},{"location":"getting-started/installation/#verify-binary","title":"Verify Binary","text":"<pre><code>./dist/otelcol-securityevent --version\n</code></pre>"},{"location":"getting-started/installation/#verify-docker-image","title":"Verify Docker Image","text":"<pre><code>docker run --rm otelcol-securityevent:latest --version\n</code></pre>"},{"location":"getting-started/installation/#verify-kubernetes-deployment","title":"Verify Kubernetes Deployment","text":"<pre><code>kubectl get pods -n otelcol-securityevent\nkubectl logs -n otelcol-securityevent -l app.kubernetes.io/name=otelcol-securityevent\n</code></pre>"},{"location":"getting-started/installation/#next-steps","title":"Next Steps","text":"<ul> <li>Quick Start Guide: Get started with a simple configuration</li> <li>Configuration Guide: Learn about configuration options</li> </ul>"},{"location":"getting-started/overview/","title":"Overview","text":"<p>The Security Log Event Processor is an OpenTelemetry Collector processor that transforms security-related logs into standardized security event logs. This document provides an overview of the processor and its capabilities.</p>"},{"location":"getting-started/overview/#what-is-the-security-log-event-processor","title":"What is the Security Log Event Processor?","text":"<p>The Security Log Event Processor is a custom processor for the OpenTelemetry Collector that:</p> <ul> <li>Transforms security logs from various sources into a standardized security event format</li> <li>Expands single log records into multiple security events (e.g., one OpenReports log with multiple results becomes multiple security events)</li> <li>Enriches events with Kubernetes metadata and workload information</li> <li>Filters events based on configurable criteria (e.g., status, severity)</li> </ul>"},{"location":"getting-started/overview/#architecture","title":"Architecture","text":"<pre><code>\u250c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2510\n\u2502  Receivers  \u2502  (k8sobjects, OTLP, etc.)\n\u2514\u2500\u2500\u2500\u2500\u2500\u2500\u252c\u2500\u2500\u2500\u2500\u2500\u2500\u2518\n       \u2502\n       \u25bc\n\u250c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2510\n\u2502 Security Event      \u2502\n\u2502 Processor           \u2502\n\u2502  \u251c\u2500 OpenReports     \u2502\n\u2502  \u2514\u2500 (more coming)   \u2502\n\u2514\u2500\u2500\u2500\u2500\u2500\u2500\u252c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2518\n       \u2502\n       \u25bc\n\u250c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2510\n\u2502  Exporters  \u2502  (OTLP, logging, etc.)\n\u2514\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2518\n</code></pre>"},{"location":"getting-started/overview/#key-concepts","title":"Key Concepts","text":""},{"location":"getting-started/overview/#processors","title":"Processors","text":"<p>Processors are the core components that transform logs. Each processor handles a specific log format:</p> <ul> <li>OpenReports Processor: Processes OpenReports Custom Resource logs from Kubernetes</li> </ul>"},{"location":"getting-started/overview/#receivers","title":"Receivers","text":"<p>Receivers collect data from various sources. The processor you choose determines which receiver you need:</p> <ul> <li>k8sobjects receiver: Required for OpenReports processor (collects Kubernetes Custom Resources)</li> <li>OTLP receiver: Optional, for receiving logs via OTLP protocol</li> <li>filelog receiver: Optional, for reading logs from files</li> </ul>"},{"location":"getting-started/overview/#security-events","title":"Security Events","text":"<p>The processor outputs standardized security events with fields like: - <code>event.id</code>: Unique event identifier - <code>event.type</code>: Type of security event - <code>dt.security.risk.level</code>: Risk level (CRITICAL, HIGH, MEDIUM, LOW) - <code>compliance.status</code>: Compliance status (COMPLIANT, NON_COMPLIANT) - <code>k8s.*</code>: Kubernetes metadata (workload, namespace, etc.)</p>"},{"location":"getting-started/overview/#use-cases","title":"Use Cases","text":"<ol> <li>Compliance Monitoring: Transform policy evaluation results into security events</li> <li>Security Event Correlation: Standardize security logs from multiple sources</li> <li>Kubernetes Security: Monitor and alert on Kubernetes security events</li> <li>Audit Logging: Create detailed audit trails from security logs</li> </ol>"},{"location":"getting-started/overview/#next-steps","title":"Next Steps","text":"<ul> <li>Installation Guide: Learn how to install the processor</li> <li>Quick Start: Get started in 5 minutes</li> <li>Configuration: Configure the processor</li> </ul>"},{"location":"getting-started/quick-start/","title":"Quick Start","text":"<p>Get the Security Log Event Processor up and running in 5 minutes!</p>"},{"location":"getting-started/quick-start/#step-1-build-the-collector","title":"Step 1: Build the Collector","text":"<pre><code># Build the collector\nmake ocb-build\n</code></pre> <p>Or build the Docker image:</p> <pre><code>make docker-build\n</code></pre>"},{"location":"getting-started/quick-start/#step-2-create-configuration-file","title":"Step 2: Create Configuration File","text":"<p>Create a file <code>config.yaml</code>:</p> <pre><code>receivers:\n  # k8sobjects receiver for collecting OpenReports Custom Resources\n  k8sobjects:\n    auth_type: serviceAccount\n    objects:\n      - name: openreports\n        mode: watch\n        api_group: openreports.io\n        api_version: v1alpha1\n        resource: reports\n\nprocessors:\n  batch:\n    timeout: 1s\n    send_batch_size: 1024\n\n  memory_limiter:\n    check_interval: 1s\n    limit_mib: 4000\n\n  # Security Event Processor\n  securityevent:\n    processors:\n      openreports:\n        enabled: true\n        status_filter:\n          - \"fail\"\n          - \"error\"\n\nexporters:\n  logging:\n    loglevel: info\n\nservice:\n  pipelines:\n    logs:\n      receivers: [k8sobjects]\n      processors: [memory_limiter, securityevent, batch]\n      exporters: [logging]\n\n  extensions: [health_check]\n\nextensions:\n  health_check:\n    endpoint: 0.0.0.0:13133\n</code></pre>"},{"location":"getting-started/quick-start/#step-3-run-the-collector","title":"Step 3: Run the Collector","text":""},{"location":"getting-started/quick-start/#using-binary","title":"Using Binary","text":"<pre><code>./dist/otelcol-securityevent --config=config.yaml\n</code></pre>"},{"location":"getting-started/quick-start/#using-docker","title":"Using Docker","text":"<pre><code>docker run -d \\\n  --name otelcol-securityevent \\\n  -p 13133:13133 \\\n  -v $(pwd)/config.yaml:/etc/otelcol/config.yaml:ro \\\n  otelcol-securityevent:latest\n</code></pre>"},{"location":"getting-started/quick-start/#using-docker-compose","title":"Using Docker Compose","text":"<pre><code>docker-compose -f docker/docker-compose.yml up -d\n</code></pre>"},{"location":"getting-started/quick-start/#using-kubernetes","title":"Using Kubernetes","text":"<pre><code># Apply manifests\nkubectl apply -f k8s/\n\n# Check status\nkubectl get pods -n otelcol-securityevent\n</code></pre>"},{"location":"getting-started/quick-start/#step-4-verify-its-working","title":"Step 4: Verify It's Working","text":""},{"location":"getting-started/quick-start/#check-health","title":"Check Health","text":"<pre><code>curl http://localhost:13133/\n</code></pre>"},{"location":"getting-started/quick-start/#check-logs","title":"Check Logs","text":"<pre><code># Docker\ndocker logs otelcol-securityevent\n\n# Kubernetes\nkubectl logs -n otelcol-securityevent -l app.kubernetes.io/name=otelcol-securityevent -f\n</code></pre> <p>You should see logs indicating the collector is processing OpenReports Custom Resources.</p>"},{"location":"getting-started/quick-start/#whats-next","title":"What's Next?","text":"<ul> <li>Configuration Guide: Learn about all configuration options</li> <li>OpenReports Processor: Detailed documentation for OpenReports</li> <li>Examples: More examples and use cases</li> </ul>"},{"location":"processors/openreports/","title":"OpenReports Processor","text":"<p>Detailed documentation for the OpenReports processor.</p>"},{"location":"processors/openreports/#overview","title":"Overview","text":"<p>The OpenReports processor transforms OpenReports Custom Resource logs from Kubernetes into standardized security events. Each policy evaluation result in an OpenReports log becomes a separate security event.</p>"},{"location":"processors/openreports/#features","title":"Features","text":"<ul> <li>\u2705 Watches OpenReports Custom Resources via k8sobjects receiver</li> <li>\u2705 Expands single log into multiple security events (one per result)</li> <li>\u2705 Configurable status filtering (pass, fail, error, skip)</li> <li>\u2705 Automatic Kubernetes workload identification</li> <li>\u2705 Rich metadata extraction (namespace, labels, ownerReferences)</li> </ul>"},{"location":"processors/openreports/#input-format","title":"Input Format","text":"<p>The processor expects OpenReports Custom Resource logs in this format:</p> <pre><code>{\n  \"kind\": \"Report\",\n  \"apiVersion\": \"openreports.io/v1alpha1\",\n  \"metadata\": {\n    \"name\": \"report-name\",\n    \"namespace\": \"default\"\n  },\n  \"results\": [\n    {\n      \"policy\": \"policy-name\",\n      \"rule\": \"rule-name\",\n      \"status\": \"fail\"\n    }\n  ]\n}\n</code></pre>"},{"location":"processors/openreports/#output-format","title":"Output Format","text":"<p>Each result produces a security event:</p> <pre><code>{\n  \"event\": {\n    \"id\": \"uuid\",\n    \"type\": \"policy-name\",\n    \"description\": \"rule-name\"\n  },\n  \"dt.security.risk.level\": \"HIGH\",\n  \"compliance.status\": \"NON_COMPLIANT\",\n  \"k8s\": {\n    \"namespace.name\": \"default\",\n    \"resource.name\": \"report-name\",\n    \"workload.name\": \"workload-name\",\n    \"workload.kind\": \"Deployment\"\n  }\n}\n</code></pre>"},{"location":"processors/openreports/#configuration","title":"Configuration","text":"<p>See OpenReports Configuration for detailed configuration options.</p>"},{"location":"processors/openreports/#field-mapping","title":"Field Mapping","text":"<p>See Field Mapping Reference for complete field mappings.</p>"},{"location":"processors/openreports/#key-mappings","title":"Key Mappings","text":"<ul> <li><code>result.policy</code> \u2192 <code>event.type</code></li> <li><code>result.rule</code> \u2192 <code>event.description</code></li> <li><code>result.status</code> \u2192 <code>compliance.status</code></li> <li><code>metadata.namespace</code> \u2192 <code>k8s.namespace.name</code></li> </ul>"},{"location":"processors/openreports/#status-filtering","title":"Status Filtering","text":"<p>Filter which results are processed:</p> <pre><code>openreports:\n  enabled: true\n  status_filter:\n    - \"fail\"    # Process failures\n    - \"error\"   # Process errors\n</code></pre> <p>Valid Statuses: - <code>pass</code>: Policy evaluation passed - <code>fail</code>: Policy evaluation failed - <code>error</code>: Policy evaluation error - <code>skip</code>: Policy evaluation skipped</p>"},{"location":"processors/openreports/#workload-identification","title":"Workload Identification","text":"<p>The processor automatically identifies Kubernetes workloads from:</p> <ol> <li>ownerReferences (primary): Extracts workload from <code>metadata.ownerReferences</code></li> <li>Pod name inference (fallback): Infers workload from pod name patterns</li> </ol> <p>Supported Workload Kinds: - Deployment - StatefulSet - DaemonSet - ReplicaSet - Job - CronJob</p>"},{"location":"processors/openreports/#example","title":"Example","text":""},{"location":"processors/openreports/#input-openreports-log","title":"Input: OpenReports Log","text":"<pre><code>{\n  \"kind\": \"Report\",\n  \"apiVersion\": \"openreports.io/v1alpha1\",\n  \"metadata\": {\n    \"name\": \"security-scan-001\",\n    \"namespace\": \"production\"\n  },\n  \"results\": [\n    {\n      \"policy\": \"pod-security\",\n      \"rule\": \"no-privileged-containers\",\n      \"status\": \"fail\"\n    },\n    {\n      \"policy\": \"network-policy\",\n      \"rule\": \"require-network-policy\",\n      \"status\": \"pass\"\n    }\n  ]\n}\n</code></pre>"},{"location":"processors/openreports/#output-security-events-with-status_filter-fail","title":"Output: Security Events (with status_filter: [\"fail\"])","text":"<p>Event 1: <pre><code>{\n  \"event\": {\n    \"id\": \"uuid-1\",\n    \"type\": \"pod-security\",\n    \"description\": \"no-privileged-containers\"\n  },\n  \"compliance.status\": \"NON_COMPLIANT\",\n  \"dt.security.risk.level\": \"HIGH\",\n  \"k8s.namespace.name\": \"production\"\n}\n</code></pre></p> <p>Event 2: (filtered out because status is \"pass\")</p>"},{"location":"processors/openreports/#use-cases","title":"Use Cases","text":"<ol> <li>Compliance Monitoring: Track policy violations in real-time</li> <li>Security Alerting: Generate alerts for failed policy evaluations</li> <li>Audit Logging: Create detailed audit trails</li> <li>Compliance Reporting: Aggregate compliance status</li> </ol>"},{"location":"processors/openreports/#troubleshooting","title":"Troubleshooting","text":""},{"location":"processors/openreports/#no-events-generated","title":"No Events Generated","text":"<ol> <li>Check if processor is enabled</li> <li>Verify status_filter includes your result statuses</li> <li>Check k8sobjects receiver is working</li> <li>Enable debug logging</li> </ol>"},{"location":"processors/openreports/#incorrect-workload-information","title":"Incorrect Workload Information","text":"<ol> <li>Verify ownerReferences in OpenReports metadata</li> <li>Check pod name follows standard patterns</li> <li>Review collector logs for extraction errors</li> </ol>"},{"location":"processors/openreports/#next-steps","title":"Next Steps","text":"<ul> <li>Configuration Guide: Configure the processor</li> <li>Field Mapping Reference: Complete field mappings</li> <li>Examples: Complete examples</li> </ul>"},{"location":"processors/overview/","title":"Processors Overview","text":"<p>Overview of available processors in the Security Log Event Processor.</p>"},{"location":"processors/overview/#available-processors","title":"Available Processors","text":""},{"location":"processors/overview/#openreports-processor","title":"OpenReports Processor","text":"<p>Transforms OpenReports Custom Resource logs into security events.</p> <p>Status: \u2705 Available Required Receiver: <code>k8sobjects</code> Documentation: OpenReports Processor</p> <p>Features: - Watches OpenReports Custom Resources - Expands single log into multiple security events (one per result) - Configurable status filtering - Automatic Kubernetes workload identification</p>"},{"location":"processors/overview/#processor-architecture","title":"Processor Architecture","text":"<pre><code>Input Log (OpenReports)\n    \u2502\n    \u251c\u2500 Result 1 \u2192 Security Event 1\n    \u251c\u2500 Result 2 \u2192 Security Event 2\n    \u2514\u2500 Result 3 \u2192 Security Event 3\n</code></pre> <p>Each processor: 1. Receives logs from configured receivers 2. Identifies matching log format 3. Transforms logs into security events 4. Applies filters (if configured) 5. Outputs security events to exporters</p>"},{"location":"processors/overview/#processor-configuration-pattern","title":"Processor Configuration Pattern","text":"<p>All processors follow the same configuration pattern:</p> <pre><code>processors:\n  securityevent:\n    processors:\n      &lt;processor-name&gt;:\n        enabled: true\n        # Processor-specific options\n</code></pre>"},{"location":"processors/overview/#choosing-a-processor","title":"Choosing a Processor","text":"Use Case Processor Receiver OpenReports CR logs OpenReports k8sobjects More coming soon... - -"},{"location":"processors/overview/#next-steps","title":"Next Steps","text":"<ul> <li>OpenReports Processor: Detailed OpenReports documentation</li> <li>Configuration Guide: Configure processors</li> </ul>"},{"location":"reference/api/","title":"API Reference","text":"<p>API reference for the Security Log Event Processor.</p>"},{"location":"reference/api/#processor-configuration","title":"Processor Configuration","text":""},{"location":"reference/api/#securityevent-processor","title":"SecurityEvent Processor","text":"<pre><code>processors:\n  securityevent:\n    processors:\n      &lt;processor-name&gt;:\n        enabled: &lt;boolean&gt;\n        # Processor-specific options\n</code></pre>"},{"location":"reference/api/#openreports-processor-api","title":"OpenReports Processor API","text":""},{"location":"reference/api/#configuration","title":"Configuration","text":"<pre><code>processors:\n  securityevent:\n    processors:\n      openreports:\n        enabled: boolean          # Required: Enable/disable processor\n        status_filter: []string   # Optional: Filter by status\n</code></pre>"},{"location":"reference/api/#status-filter-values","title":"Status Filter Values","text":"<ul> <li><code>pass</code>: Policy evaluation passed</li> <li><code>fail</code>: Policy evaluation failed</li> <li><code>error</code>: Policy evaluation error</li> <li><code>skip</code>: Policy evaluation skipped</li> </ul>"},{"location":"reference/api/#next-steps","title":"Next Steps","text":"<ul> <li>Configuration Guide: Detailed configuration</li> <li>Field Mapping: Field mappings</li> </ul>"},{"location":"reference/field-mapping/","title":"Field Mapping Reference","text":"<p>Complete field mapping from source logs to security events.</p>"},{"location":"reference/field-mapping/#openreports-to-security-event-mapping","title":"OpenReports to Security Event Mapping","text":""},{"location":"reference/field-mapping/#event-fields","title":"Event Fields","text":"Source Field Target Field Type Description Generated UUID <code>event.id</code> string Unique event identifier <code>result.policy</code> <code>event.type</code> string Policy name <code>result.rule</code> <code>event.description</code> string Rule description <code>metadata.timestamp</code> <code>event.timestamp</code> timestamp Event timestamp"},{"location":"reference/field-mapping/#security-fields","title":"Security Fields","text":"Source Field Target Field Type Description Calculated from status <code>dt.security.risk.level</code> string CRITICAL, HIGH, MEDIUM, LOW Calculated from status <code>dt.security.risk.score</code> number 0-10 risk score <code>result.status</code> <code>compliance.status</code> string COMPLIANT, NON_COMPLIANT"},{"location":"reference/field-mapping/#kubernetes-fields","title":"Kubernetes Fields","text":"Source Field Target Field Type Description <code>metadata.namespace</code> <code>k8s.namespace.name</code> string Kubernetes namespace <code>metadata.name</code> <code>k8s.resource.name</code> string Resource name Extracted from ownerReferences <code>k8s.workload.name</code> string Workload name Extracted from ownerReferences <code>k8s.workload.kind</code> string Workload kind Extracted from ownerReferences <code>k8s.workload.uid</code> string Workload UID <code>metadata.namespace</code> <code>k8s.workload.namespace</code> string Workload namespace"},{"location":"reference/field-mapping/#risk-level-calculation","title":"Risk Level Calculation","text":"<p>Risk levels are calculated based on result status:</p> Status Risk Level Risk Score <code>fail</code> HIGH 8.5 <code>error</code> CRITICAL 9.5 <code>pass</code> LOW 2.0 <code>skip</code> MEDIUM 5.0"},{"location":"reference/field-mapping/#compliance-status-mapping","title":"Compliance Status Mapping","text":"Source Status Compliance Status <code>pass</code> COMPLIANT <code>fail</code> NON_COMPLIANT <code>error</code> NON_COMPLIANT <code>skip</code> NON_COMPLIANT"},{"location":"reference/field-mapping/#example-mapping","title":"Example Mapping","text":""},{"location":"reference/field-mapping/#input-openreports-log","title":"Input: OpenReports Log","text":"<pre><code>{\n  \"kind\": \"Report\",\n  \"apiVersion\": \"openreports.io/v1alpha1\",\n  \"metadata\": {\n    \"name\": \"scan-001\",\n    \"namespace\": \"production\",\n    \"ownerReferences\": [\n      {\n        \"kind\": \"Deployment\",\n        \"name\": \"my-app\",\n        \"uid\": \"12345678-1234-1234-1234-123456789012\"\n      }\n    ]\n  },\n  \"results\": [\n    {\n      \"policy\": \"pod-security\",\n      \"rule\": \"no-privileged-containers\",\n      \"status\": \"fail\"\n    }\n  ]\n}\n</code></pre>"},{"location":"reference/field-mapping/#output-security-event","title":"Output: Security Event","text":"<pre><code>{\n  \"event\": {\n    \"id\": \"550e8400-e29b-41d4-a716-446655440000\",\n    \"type\": \"pod-security\",\n    \"description\": \"no-privileged-containers\",\n    \"timestamp\": \"2024-01-15T10:30:00Z\"\n  },\n  \"dt.security.risk.level\": \"HIGH\",\n  \"dt.security.risk.score\": 8.5,\n  \"compliance.status\": \"NON_COMPLIANT\",\n  \"k8s.namespace.name\": \"production\",\n  \"k8s.resource.name\": \"scan-001\",\n  \"k8s.workload.name\": \"my-app\",\n  \"k8s.workload.kind\": \"Deployment\",\n  \"k8s.workload.uid\": \"12345678-1234-1234-1234-123456789012\",\n  \"k8s.workload.namespace\": \"production\"\n}\n</code></pre>"},{"location":"reference/field-mapping/#next-steps","title":"Next Steps","text":"<ul> <li>OpenReports Processor: Processor details</li> <li>Configuration Guide: Configuration options</li> </ul>"},{"location":"reference/metrics/","title":"Metrics Reference","text":"<p>Telemetry metrics exposed by the Security Log Event Processor.</p>"},{"location":"reference/metrics/#available-metrics","title":"Available Metrics","text":""},{"location":"reference/metrics/#incoming-logs","title":"Incoming Logs","text":"<p>Metric: <code>securityevent.logs.incoming</code> Type: Counter Description: Total number of incoming log records Labels: None</p>"},{"location":"reference/metrics/#outgoing-logs","title":"Outgoing Logs","text":"<p>Metric: <code>securityevent.logs.outgoing</code> Type: Counter Description: Total number of outgoing log records (after processing) Labels: None</p>"},{"location":"reference/metrics/#dropped-logs","title":"Dropped Logs","text":"<p>Metric: <code>securityevent.logs.dropped</code> Type: Counter Description: Total number of logs dropped due to processing errors Labels: None</p>"},{"location":"reference/metrics/#processing-errors","title":"Processing Errors","text":"<p>Metric: <code>securityevent.processing.errors</code> Type: Counter Description: Total number of processing errors Labels: - <code>error_type</code>: Type of error (e.g., \"processing_error\")</p>"},{"location":"reference/metrics/#metric-collection","title":"Metric Collection","text":"<p>Metrics are exposed via the collector's telemetry system and can be scraped by Prometheus or other monitoring systems.</p>"},{"location":"reference/metrics/#example-query","title":"Example Query","text":"<pre><code># Rate of incoming logs\nrate(securityevent.logs.incoming[5m])\n\n# Rate of dropped logs\nrate(securityevent.logs.dropped[5m])\n\n# Error rate\nrate(securityevent.processing.errors[5m])\n</code></pre>"},{"location":"reference/metrics/#next-steps","title":"Next Steps","text":"<ul> <li>Configuration Guide: Configuration options</li> <li>Troubleshooting: Debugging guide</li> </ul>"}]}